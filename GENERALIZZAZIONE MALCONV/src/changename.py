import csv
import glob
from tqdm import tqdm 

lista_nomi = []
labels = []

classes = glob.glob('/home/semanos/VALIDATION/data/test'+'/')
for i, class_path in enumerate(classes):
  class_name = class_path.replace('/home/semanos/VALIDATION/data/test/','')
  #This loop iterates in whole directory and gets all the feature from the exe files
  for sample in tqdm(glob.glob(class_path+'/'), desc=f'({i+1}{len(classes)}) {class_name}'):
    lista_nomi.append(sample.split("/")[-1])

    if("benign" in class_path):
      labels.append(0)  #LABLING BENIGN AS 0
    else:
      labels.append(1) #LABELING EVIL AS 1

k=0
with open('/home/semanos/VALIDATION/data/features_testset2m.csv', 'w') as f:
  writer = csv.writer(f, delimiter = ',')
  for val in lista_nomi:
    writer.writerow([val, labels[k]])
    k=k+1
